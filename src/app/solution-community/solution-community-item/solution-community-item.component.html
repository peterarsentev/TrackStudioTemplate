<div class="container-fluid">
  <div class="row">
    <div class="w-100 pull-right mb-2">
      <a *ngIf="!!solutionCommunity?.nextId && solutionCommunity?.nextId !== -1"
         type="button" class="m btn btn-light btn-sm pull-right"
         [routerLink]="['/solution_community','item', solutionCommunity?.nextId]">Следующая<i class="fas fa-angle-right pl-1"></i></a>
      <a *ngIf="!!solutionCommunity?.previousId && solutionCommunity?.previousId !== -1"
         type="button" class="m btn btn-light pull-right btn-sm mr-2"
          [routerLink]="['/solution_community','item', solutionCommunity?.previousId]"><i class="fas fa-angle-left pr-1"></i>Предыдущая</a>
    </div>
  </div>
  <div class="row">
    <div class="w-100 card ">
      <div class="card-header">
        <span class="w-50 font-weight-bold">
          {{ solutionCommunity?.name }}
        </span><br/>
      </div>
      <div class="card-body pre-scrollable">
        <div class="card-text" [innerHTML]="solutionCommunity?.description"></div>
      </div>
    </div>

    <div class="w-100 card mt-3">
      <div class="card-header">
        <span class="w-50 font-weight-bold">
          Решение
        </span><br/>
        <span class="text-muted small">
          Автор: {{ solutionCommunity?.userName }} | Решено: {{ solutionCommunity?.created | date:'dd.MM.yyyy hh:MM' }}
        </span><br/>
      </div>
      <div class="card-body">
        <div class="card-text" *ngIf="solutionCommunity?.operationId"
             [innerHTML]="solutionCommunity.solution"></div>
        <div class="card-text" *ngIf="solutionCommunity?.solutionCodeId">
            <ngx-codemirror
              [(ngModel)]="solutionCommunity.solution"
              [options]="options"
            ></ngx-codemirror>
        </div>
      </div>
    </div>
  </div>

    <div class="row mt-3">
      <div class="card w-100">
        <div class="card-header">
          <div class="font-weight-bold">Комментарии</div>
          <div class="small text-muted">Проведите код-ревью решения:
            оставьте рекомендации по улучшению или похвалите за качественную работу.</div>
        </div>
        <div class="card-body">
          <table class="table" *ngIf="solutionCommunityOperations.length > 0">
            <ng-container *ngFor="let operation of solutionCommunityOperations; let idx=index">
              <tr>
                <td>
                  <div class="pb-3 small">
                  <span>
                    <span class="font-weight-bold" style="cursor: pointer;">
                      <i class="fa fa-user mr-1"></i>{{ operation.userName }}</span>
                  </span>
                    <span class="pull-right">{{ operation.created | date: 'dd.MM.yyyy HH:mm' }}</span>
                  </div>
                  <div [innerHTML]="operation.text | safeCode"></div>
                </td>
              </tr>
            </ng-container>
          </table>
          <div *ngIf="solutionCommunityOperations.length == 0">
            Сделай лучше, стань первым, кто проведет код-ревью этого решения!
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <button (click)="showAddCommentForm(true)" class="pull-left btn btn-success btn-sm mt-2">
        Комментировать</button>
    </div>

    <div class="row" *ngIf="addFormComment">
      <app-discussion
        title="Комментарий"
        (closeEmitter)="saveComment($event)"
      ></app-discussion>
    </div>

</div>
