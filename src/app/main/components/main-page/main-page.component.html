<div class="container-fluid">
  <app-chart [activity]="ua"></app-chart>
  <app-chart [activity]="uaSolved"></app-chart>
  <div class="row">
    <table class="table">
      <thead>
      <tr>
        <th scope="col">Прогресс обучения</th>
        <th scope="col"></th>
      </tr>
      </thead>discuss_operation
      <tbody>
      <tr>
        <td>Выполнено / всего:</td>
        <td>
          <app-progress-bar-view [allTasksCount]="allTasksCount"
                                 [solvedTasksCount]="solvedTasksCount"
                                 [barValue]="tasksBarValue"
          ></app-progress-bar-view>
        </td>
      </tr>
      <tr>
        <td>Выполнено упражнений / всего:</td>
        <td>
          <app-progress-bar-view [allTasksCount]="totalExerciseCount"
                                 [solvedTasksCount]="solvedExerciseCount"
                                 [barValue]="solBarValue"
          ></app-progress-bar-view>
        </td>
      </tr>
      <tr>
        <td>Начало обучения:</td>
        <td>{{ submitDate | getDate }}</td>
      </tr>
      <tr>
        <td>Последняя активность в курсе:</td>
        <td>{{ updateDate | getDate }}</td>
      </tr>
      <tr>
        <td>Всего дней с начала обучения:</td>
        <td>{{ countOfDays }}</td>
      </tr>
      <tr>
        <td>Количество задач в день:</td>
        <td>{{ speed | number: '1.2-2' }}</td>
      </tr>
      <tr>
        <td>Ожидаемая дата завершения:</td>
        <td>{{ endOfCourse }}</td>
      </tr>
      </tbody>
    </table>
  </div>
  <div *ngIf="!!levels" class="row">
    <table class="table">
      <thead>
      <tr>
        <th scope="col">Доступные уровни:</th>
        <th scope="col"></th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let l of levels">
        <td>
          {{ l.name }}
        </td>
        <td>
          <app-progress-bar-view [allTasksCount]="l.all"
                                 [solvedTasksCount]="l.solved"
                                 [barValue]="l.progress"
          ></app-progress-bar-view>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
  <div *ngIf="provenTasks.length > 0" class="row pt-3">
    <table class="table">
      <thead>
      <tr>
        <th scope="col">Задачи на исправление: {{ provenTasks?.length }}</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let task of provenTasks; let idx = index">
        <td>
          <div>
            <a [routerLink]="['exercise', task.task.topicId, 'task-view', task.task.taskId, 'solutionId', task.solution.id]">
            <span class="font-weight-bold">
              <i class="fas fa-tasks pr-3"></i>
              {{task.task.taskName}}
            </span>
            </a>
          </div>
          <small class="mb-2 text-muted">
            <span>
              <span *ngIf="task.status.start" class="badge badge-danger mr-3">{{ task.status.statusName }}</span>
              <span *ngIf="task.status.finish" class="badge badge-success mr-3">{{ task.status.statusName }}</span>
              <span *ngIf="!(task.status.finish || task.status.start)"
                    class="badge badge-warning mr-3">{{ task.status.statusName }}</span>
              <span *ngIf="task.handler" class="mr-3">Ответственный : {{ task.handler.name }}</span>
            </span>
            <span class="mr-3">Создана : {{ task.solution.createdTime | date: 'hh:mm dd.MM.yyyy' }}</span>
            <span class="mr-3">Обновлена : {{  task.solution.updatedTime | date: 'hh:mm dd.MM.yyyy' }}</span>
            <span
              class="mr-3"> Потрачено : {{ getSpentDays(task.solution.createdTime, task.solution.updatedTime)}}
            </span>
          </small>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
  <div class="row pt-3">
    <table class="table">
      <thead>
      <tr>
        <th scope="col">Выполненные задачи : {{doneTasks?.length}}</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let task of doneTasks; let idx = index">
        <td>
          <div>
            <a [routerLink]="['exercise', task.task.topicId, 'task-view', task.task.taskId, 'solutionId', task.solution.id]">
            <span class="font-weight-bold">
              <i class="fas fa-tasks pr-3"></i>
              {{task.task.taskName}}
            </span>
            </a>
          </div>
          <small class="mb-2 text-muted">
            <span>
                <span *ngIf="task.status.finish" class="badge badge-success mr-3">{{ task.status.statusName }}</span>
              <span *ngIf="task.handler" class="mr-3">Ответственный : {{ task.handler.name }}</span>
            </span>
            <span class="mr-3">Создана : {{ task.handler.created | date: 'hh:mm dd.MM.yyyy' }}</span>
            <span class="mr-3">Обновлена : {{  task.solution.updatedTime | date: 'hh:mm dd.MM.yyyy' }}</span>
            <span
              class="mr-3"> Потрачено : {{ getSpentDays(task.solution.createdTime, task.solution.updatedTime)}}
            </span>
          </small>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
  <div class="row pt-3">
    <table class="table">
      <thead>
      <tr>
        <th scope="col">Новые задачи : {{newTasks?.length}}</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let task of newTasks; let idx = index">
        <td>
          <div>
            <a [routerLink]="['exercise', task.task.topicId, 'task-view', task.task.taskId]">
            <span class="font-weight-bold">
              <i class="fas fa-tasks pr-3"></i>
              {{task.task.taskName}}
            </span>
            </a>
          </div>
          <small class="mb-2 text-muted">
            <span>
              <span *ngIf="task.status.start" class="badge badge-danger mr-3">{{ task.status.statusName }}</span>
              <span *ngIf="task.handler" class="mr-3">Ответственный : {{ task.handler.name }}</span>
            </span>
            <span class="mr-3">Создана : {{ task.handler.created | date: 'hh:mm dd.MM.yyyy' }}</span>
          </small>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
